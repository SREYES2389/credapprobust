<script>
    // =================================================================
    // 2. API ABSTRACTION LAYER
    // =================================================================

    /**
     * A promise-based wrapper for google.script.run to make asynchronous calls cleaner.
     * This centralizes the backend communication logic.
     */
    const api = {
        run(functionName, ...args) {
            return new Promise((resolve, reject) => {
                google.script.run
                    .withSuccessHandler(resolve)
                    .withFailureHandler(reject)
                [functionName](...args);
            });
        }
    };

</script>